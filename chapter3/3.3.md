# 第三课：列表页
  
上一节课我们做好了所有的准备工作，我们现在就要开始进行实际创作了。本课我们将聚焦于**Home**页来把它改造成用来展示GIF回馈的列表页。  
  
## Reddit提供者
我们将要创建的布局严重的依赖从reddit拉取的数据，我们决定了创建一个提供者来为我们做这些操作。我们现在不会进入reddit提供者的实现细节，但是我们现在得设置好我们最终将要用到的函数，这样可以在本课中用上他们。  
**> 修改 src/providers/reddit.ts为如下：**
```typescript
import { Injectable } from '@angular/core';
import { Http } from '@angular/http';
import 'rxjs/add/operator/map';

@Injectable()
export class Reddit {
    settings: any;
    loading: boolean = false;
    posts: any = [];
    subreddit: string = 'gifs';
    page: number = 1;
    perPage: number = 15;
    after: string;
    stopIndex: number;
    sort: string = 'hot'
    moreCount: number = 0;

    constructor(public http: Http) {

    }

    fetchData(): void {

    }
}
```
这几本书就是这个提供者的股价，他定义了大量的成员变量和*fetchData*函数用于从reddit获取数据。成员函数的作用是什么现在可能不是很明显，我们还是（按顺序）了解一下吧：
* 用户提供的设置settings
* 是否加载了当前新的GIF 
* 当前加载完成的所有的GIF的入口
* 当前的subreddit
* 当前页（即，用户点击“Load More”的次数）
* 每页展示的GIF的数量
* 最后一个从Reddit拉取的帖子的引用（这样我们就知道下次从哪个页面开始）
* 用于存储帖子数组的长度
* GIF排列依据
* 应用会持续向reddit拉取数据直到够一页的数据，moreCount告诉它加载更多是具体多少（即，如果在请求API20次还不够的话）

我们希望尽快完成这个提供者，但是现在我们还是先完成home页面布局。  
  
## 布局
在开始制作这个布局之前，也就是**home.html**，我们先看一下效果图：  
![Giflist 2](/imgs/3.1.2.jpg)  
  
这是一个很简单的布局，顶部一个导航条，包含一个搜索条一个设置按钮（用于启动Settings页面）。在他下面是一系列的从Reddit返回的GIF列表。还有截屏里面没有显示的列表底部的‘Load More’按钮，用户点击这个按钮的时候将会加载下一页的GIF。  
首先我们看一下整个模板，然后分成各个小块来详细讲解。  
**> 修改 src/pages/home/home.html为如下：**
```html
<ion-header>
    <ion-navbar color="secondary">
        <ion-title>
            <ion-searchbar color="primary" placeholder="enter subreddit name..."></ion-searchbar>
        </ion-title>
        <ion-buttons end>
            <button ion-button icon-only (click)="openSettings()"><ion-icon name="settings"></ion-icon></button>
        </ion-buttons>
    </ion-navbar>
</ion-header>
<ion-content>
    <ion-list>
        <ion-item no-lines>
        GIF GOES HERE
        </ion-item>
        <ion-list-header>
        TITLE GOES HERE
        </ion-list-header>
        <ion-item *ngIf="redditService.loading" no-lines style="text-align:center;">
            <img src="assets/images/loader.gif" style="width: 50px" />
        </ion-item>
    </ion-list>
    <button ion-button full color="light" (click)="loadMore()">Load More...</button>
</ion-content>
```
第一部分设置了导航条：
```html
<ion-navbar color="secondary">
    <ion-title>
        <ion-searchbar color="primary" placeholder="enter subreddit name..."></ion-searchbar>
    </ion-title>

    <ion-buttons end>
        <button ion-button icon-only (click)="openSettings()"><ion-icon name="settings"></ion-icon></button>
    </ion-buttons>
</ion-navbar>
```
我们给*<ion-navbar>*添加了*secondary*是属性这样后续会将他样式调整到使用secondary颜色。  
我们用了*<ion-title>*，这个组件通常是用来在navbar中展示标题的，这里我们用来将搜索条调整到navbar的居中位置。通常每个搜索条会有一个单独的工具栏这样它会占用整个空间，但是我不想让屏幕看起来很乱所以这里用它来稍微调整一下。为了能够让他恰当的去工作，我们后续会添加一些自定义样式。我们也给搜索条提供了primary属性这样他会用primary颜色。  
然后，我们使用*<ion-buttons>*来防止我们的设置按钮，这个按钮会启动设置页面。使用end指令可以将按钮放到右边，如果想把按钮放到左边的话那么就用start指令。我们也给按钮添加了一个*(click)*监听器这样在点击按钮的时候会调用*openSettings*函数。我们现在没有创建这个函数所以现在点击的时候什么都不会发生，但是我们稍后会在**home.ts**中定义。  
接下来我们定义了主题内容区域：
```html
<ion-list>
    <ion-item no-lines>
    GIF GOES HERE
    </ion-item>

    <ion-list-header>
    TITLE GOES HERE
    </ion-list-header>
    <ion-item *ngIf="loading" no-lines style="text-align: center;">
        <img src="assets/images/loader.gif" style="width: 50px" />
    </ion-item>
</ion-list>
```
